<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–∫—ñ–ª—å–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>üìö –®–∫—ñ–ª—å–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä</h1>

<!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è -->
<div class="menu">
    <button onclick="showSection('schedule')">–†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤</button>
    <button onclick="authenticate()">–î–æ–º–∞—à–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è</button>
    <button onclick="showSection('weekly-tasks')">–ó–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å</button>
</div>

<!-- –†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤ -->
<div id="schedule" class="section">
    <h2>üìÖ –†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤</h2>
    <table>
        <thead>
            <tr>
                <th>–î–µ–Ω—å</th>
                <th>–£—Ä–æ–∫–∏</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>–ü–æ–Ω–µ–¥—ñ–ª–æ–∫</td>
                <td>–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –§—ñ–∑–∏–∫–∞, –ê–Ω–≥–ª—ñ–π—Å—å–∫–∞</td>
            </tr>
            <tr>
                <td>–í—ñ–≤—Ç–æ—Ä–æ–∫</td>
                <td>–•—ñ–º—ñ—è, –õ—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞, –Ü—Å—Ç–æ—Ä—ñ—è</td>
            </tr>
        </tbody>
    </table>
</div>
 
<!-- –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (–∑ –ø–∞—Ä–æ–ª–µ–º) -->
<div id="homework" class="section" style="display: none;">
    <h2>üìù –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è</h2>
    <table id="taskTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>–î–µ–Ω—å</th>
                <th>–£—Ä–æ–∫</th>
                <th>–ó–∞–≤–¥–∞–Ω–Ω—è</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <button onclick="saveData()">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
</div>

<!-- –ó–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å -->
<div id="weekly-tasks" class="section" style="display: none;">
    <h2>‚úÖ –ó–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å</h2>
    <table id="weeklyTasksTable">
        <thead>
            <tr>
                <th>–î–µ–Ω—å</th>
                <th>–£—Ä–æ–∫</th>
                <th>–ó–∞–≤–¥–∞–Ω–Ω—è</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    const PASSWORD = "1234"; // –ü–∞—Ä–æ–ª—å –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è

    function showSection(sectionId) {
        document.querySelectorAll('.section').forEach(section => {
            section.style.display = 'none';
        });
        document.getElementById(sectionId).style.display = 'block';
    }

    function authenticate() {
        const inputPassword = prompt("–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è:");
        if (inputPassword === PASSWORD) {
            showSection('homework');
        } else {
            alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ä–æ–ª—å!");
        }
    }

    let tasks = [];

    async function loadData() {
        const response = await fetch("https://4e71-185-204-68-95.ngrok-free.app/data"); //–¢—É—Ç –í—Å—Ç–∞–≤–∏—Ç–∏ —Å–∏–ª–∫—É –Ω–∞ —Å–∞–º —Å–∞–π—Ç
        tasks = await response.json();
        renderTables();
    }

    function renderTables() {
        const taskTable = document.querySelector("#taskTable tbody");
        const weeklyTasksTable = document.querySelector("#weeklyTasksTable tbody");
        
        taskTable.innerHTML = "";
        weeklyTasksTable.innerHTML = "";

        tasks.forEach((task, index) => {
            // –î–æ–º–∞—à–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è (–¥–æ—Å—Ç—É–ø–Ω—ñ –ª–∏—à–µ –ø—ñ—Å–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è)
            taskTable.innerHTML += `
                <tr>
                    <td>${task.id}</td>
                    <td><input type="text" value="${task.day}" onchange="updateTask(${index}, 'day', this.value)"></td>
                    <td><input type="text" value="${task.subject}" onchange="updateTask(${index}, 'subject', this.value)"></td>
                    <td><input type="text" value="${task.name}" onchange="updateTask(${index}, 'name', this.value)"></td>
                </tr>
            `;

            // –ó–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å
            weeklyTasksTable.innerHTML += `
                <tr>
                    <td>${task.day}</td>
                    <td>${task.subject}</td>
                    <td>${task.name}</td>
                </tr>
            `;
        });
    }

    function updateTask(index, field, value) {
        tasks[index][field] = value;
    }

    async function saveData() {
        await fetch('http://localhost:3000/update', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(tasks)
        });
        alert("–î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!");
        renderTables();
    }

    loadData();
</script>

</body>
</html>
